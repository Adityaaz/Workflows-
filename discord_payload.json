name: Update Discord Message

on:
  push:
    branches:
      - main

jobs:
  update-message:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Prepare JSON payload
        id: prepare_payload
        run: |
          cat <<EOF > payload.json
          {
            "content": "Updated message content",
            "embeds": [
              {
                "title": "Updated Embed Title",
                "description": "Updated embed description",
                "color": 3447003
              }
            ]
          }
          EOF
        shell: bash

      - name: Update message in Discord
        run: |
          curl -X PATCH "${{ secrets.DISCORD_WEBHOOK_URL }}/messages/${{ secrets.DISCORD_MESSAGE_ID }}" \
          -H "Content-Type: application/json" \
          -d @payload.json
        shell: bash
